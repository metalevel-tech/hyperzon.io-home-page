const nodes={galleryOverlay:document.getElementById("gallery-preview-overlay"),galleryContent:document.getElementById("gallery-preview-overlay").querySelector(".gallery-preview-content"),galleryButtonClose:document.getElementById("gallery-preview-overlay").querySelector(".button-3x"),galleryButtonNext:document.getElementById("gallery-preview-overlay").querySelector(".gallery-preview-next"),galleryButtonBack:document.getElementById("gallery-preview-overlay").querySelector(".gallery-preview-back")},isSafari=void 0!==window.safari;class galleryUrlArray{constructor(e=!1,t=[]){this.current=e,this.list=t}findNext(){var e=this.list.indexOf(this.current);return-1!==e&&(this.list[e+1]||this.list[0])}findBack(){var e=this.list.indexOf(this.current);return-1!==e&&(this.list[e-1]||this.list[this.list.length-1])}}function galleryOverlayClear(){nodes.galleryOverlay.querySelectorAll("video").forEach(function(e){try{e.pause(),e.load(),e.src="",e.remove()}catch(e){console.log(e)}}),nodes.galleryButtonBack.removeEventListener("click",changeVideo),nodes.galleryButtonNext.removeEventListener("click",changeVideo),window.removeEventListener("resize",calcHeightOnDeviceTilt),window.removeEventListener("orientationChange",calcHeightOnDeviceTilt),nodes.galleryOverlay.querySelectorAll("img").forEach(function(e){try{e.src="",e.remove()}catch(e){console.log(e)}}),nodes.galleryButtonBack.removeEventListener("click",changeImage),nodes.galleryButtonNext.removeEventListener("click",changeImage),document.body.classList.remove("no-scroll"),nodes.galleryOverlay.classList.remove("active"),nodes.galleryButtonClose.classList.remove("active"),nodes.galleryButtonNext.classList.remove("active"),nodes.galleryButtonBack.classList.remove("active")}function changeImage(e,t=!0){const l=nodes.galleryContent.querySelector("img.image-preview");if(!l)return!1;const r=t?e.findNext():e.findBack();if(!r)return!1;e.current=r,l.classList.add("static"),setTimeout(function(){l.setAttribute("src",""),setTimeout(function(){l.setAttribute("src",r),l.classList.remove("static")},150)},150)}function changeVideo(e,t=!0){var l=nodes.galleryContent.querySelector("video.video-preview");return!!l&&(!!(t=t?e.findNext():e.findBack())&&(e.current=t,void(l.src=t)))}function overlaySetUp_Image(e,t){galleryOverlayClear(),t.current=e.href;e=document.createElement("img");e.setAttribute("class","image-preview"),e.setAttribute("src",t.current),isSafari?e.classList.add("browser-safari"):e.classList.add("browser-not-safari"),nodes.galleryContent.appendChild(e)}function overlaySetUp_Video(e,t){galleryOverlayClear(),t.current=e.querySelector("source").src;const l=document.createElement("video");l.setAttribute("autoplay",""),l.setAttribute("controls",""),l.setAttribute("playsinline",""),l.setAttribute("muted",""),l.setAttribute("class","video-preview"),l.volume=.4,l.setAttribute("src",t.current),l.onended=e=>{changeVideo(t,!0)},isSafari?l.classList.add("browser-safari"):l.classList.add("browser-not-safari"),nodes.galleryContent.appendChild(l),setTimeout(function(){calcHeightOnDeviceTilt(l)},100),window.addEventListener("resize",calcHeightOnDeviceTilt.bind(this,l)),window.addEventListener("orientationChange",calcHeightOnDeviceTilt.bind(this,l))}function setHeight_16_9(e){if(!e)return!1;e.style.height=Math.floor(9*e.offsetWidth/16+2)+"px"}function calcHeightOnDeviceTilt(t){if(!t)return!1;setTimeout(function(){var e=window.innerHeight-90;e<=t.offsetHeight?(t.style.height=Math.floor(2+e)+"px",t.style.width=Math.floor(16*e/9)+"px"):setTimeout(()=>{t.style.height="",t.style.width=""},200)},100)}function imageGalleryHandler(){var e=document.querySelectorAll(".image-gallery");e.length&&e.forEach(function(e){e=[...e.querySelectorAll(".image-item")];const t=new galleryUrlArray(!1,e.map(e=>e.href));nodes.galleryButtonClose.addEventListener("click",function(e){galleryOverlayClear()}),e.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),galleryOverlayClear(),overlaySetUp_Image(e.target.closest(".image-item"),t),document.body.classList.add("no-scroll"),nodes.galleryOverlay.classList.add("active"),setTimeout(function(){nodes.galleryButtonClose.classList.add("active"),nodes.galleryButtonNext.classList.add("active"),nodes.galleryButtonBack.classList.add("active")},100),nodes.galleryButtonNext.addEventListener("click",changeImage.bind(this,t,!0)),nodes.galleryButtonBack.addEventListener("click",changeImage.bind(this,t,!1))})})})}function videoGalleryHandler(){var e=document.querySelectorAll(".video-gallery");e.length&&e.forEach(e=>{e=[...e.querySelectorAll(".video-item")];const t=new galleryUrlArray(!1,e.map(e=>e.querySelector("source").src));nodes.galleryButtonClose.addEventListener("click",function(e){galleryOverlayClear()}),e.forEach(e=>{e.addEventListener("loadeddata",()=>{e.loaded||(e.loaded=!0,e.loaded&&e.paused&&e.play())}),e.addEventListener("mouseenter",()=>{e.loaded&&e.paused?e.play():e.load()}),e.addEventListener("mouseleave",()=>{setTimeout(()=>{e.loaded&&!e.paused&&e.pause()},500)}),e.addEventListener("click",e=>{e.preventDefault(),galleryOverlayClear(),overlaySetUp_Video(e.target,t),document.body.classList.add("no-scroll"),nodes.galleryOverlay.classList.add("active"),setTimeout(function(){nodes.galleryButtonClose.classList.add("active"),nodes.galleryButtonNext.classList.add("active"),nodes.galleryButtonBack.classList.add("active")},100),nodes.galleryButtonNext.addEventListener("click",changeVideo.bind(this,t,!0)),nodes.galleryButtonBack.addEventListener("click",changeVideo.bind(this,t,!1))})})})}export{imageGalleryHandler,videoGalleryHandler};